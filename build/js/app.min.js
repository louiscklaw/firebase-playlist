function json_pretty_print (json_in) {
  return JSON.stringify( json_in, null, 2 );
}

var helloworld = 'helloworld';

const LOCAL_API_SERVER = 'http://localhost:5000/test-firebase-3a0f6/us-central1';

const API_SERVER = LOCAL_API_SERVER;

const API_PATH = `${API_SERVER}/main/api/jstest`;

const METHOD_POST = { method: 'POST' };
const METHOD_PUT = { method: 'PUT' };
const METHOD_DELETE = { method: 'DELETE' };
const HEADERS_JSON = { headers: { 'Content-Type': 'application/json' } };


function clickLogin () {
  alert( 'login clicked' );
}

function queryStatus () {
  alert( 'query Status clicked' );
}
function helloworld() {
  console.log( 'helloworld' );
}

const get_ele = ( sel_in ) => {
  return document.querySelector( sel_in )
};
const get_eles = ( sel_in ) => {
  return document.querySelectorAll( sel_in )
};

const prepare_get_request = ( endpoint ) => {
  return fetch( `${API_PATH}/${endpoint}` );
}

const prepare_put_request = ( endpoint ) => {
  return fetch( `${API_PATH}/${endpoint}`, create_json_put_config() );
}

function create_json_put_config( json_in ) {
  return {
    ...METHOD_PUT,
    ...HEADERS_JSON,
    body: JSON.stringify( json_in )
  };
}

const create_delete_config = ( ) => {
  return {
    ...METHOD_DELETE
  };
}

function create_json_post_config( json_in ) {
  return {
    ...METHOD_POST,
    ...HEADERS_JSON,
    body: JSON.stringify( json_in )
  };
}

function clickCreate() {
  fetch( `${API_PATH}/create_fight`, create_json_post_config( {
      winner: get_ele( '#create_winner' ).value,
      losser: get_ele( '#create_losser' ).value,
      title: get_ele( '#create_title' ).value
    } ) )
    .then( res => res.json() )
    .then( res_json => {
      refreshLists();
      get_ele( '#create_result' ).innerHTML = JSON.stringify( res_json );
    } )

}

function click_echo_get() {
  fetch( `${API_PATH}/echo_get?q=1234` )
    .then( res => res.text() )
    .then( res_text => {
      console.log( res_text )
      get_ele( '#echo_get' ).innerHTML = res_text;
    } )
}

function click_hello_get() {
  fetch( `${API_PATH}/hello_get` )
    .then( res => res.text() )
    .then( res_text => {
      console.log( res_text );
      get_ele( '#hello_get' ).innerHTML = res_text;
    } )
}

function click_list_all() {
  fetch( `${API_PATH}/fights` )
    .then( res => res.json() )
    .then( res_json => {
      get_ele( '#list_all_result' ).innerHTML = JSON.stringify( res_json );
    } )
}

function fetch_records() {
  return fetch( `${API_PATH}/fights` )
    .then( res => res.json() );
}

function prepareRecordList ( eles_in ) {

  fetch_records()
    .then( res_json => {
      eles_in.forEach( ele_in => {
        emptyList(ele_in);
        Object.keys( res_json ).forEach( _id => {
          var sel = ele_in;
          var opt1 = document.createElement( "option" );
          opt1.value = _id;
          opt1.text = _id;
          sel.add( opt1, null );
        } );
      })


    } )
}

function loadRecord( id_in ) {
  return prepare_get_request( `/fight/${id_in}` )
    .then( res => res.json() )

}

function readRecord( id_in ) {
  prepare_get_request( `/fight/${id_in}` )
    .then( res => res.json() )
    .then( res_json => {
      get_ele( '#read_winner' ).value = res_json.value.winner;
      get_ele( '#read_losser' ).value = res_json.value.losser;
      get_ele( '#read_title' ).value = res_json.value.title;
    } )
}

function onUpdateSelectChange( ele_in ) {
  var id_to_load = ele_in.value;
  loadRecord( id_to_load )
    .then( res_json => {
      get_ele( '#update_winner' ).value = res_json.value.winner;
      get_ele( '#update_losser' ).value = res_json.value.losser;
      get_ele( '#update_title' ).value = res_json.value.title;
    } )
}

function updateRecord() {
  var id_to_update = get_ele( '#update_records_list' ).value;
  var fetch_url = `${API_PATH}/fights/${id_to_update}`;
  console.log( fetch_url );

  fetch( fetch_url, create_json_put_config( {
      // winner: get_ele( '#update_winner' ).value,
      // losser: get_ele( '#update_losser' ).value,
      title: get_ele( '#update_title' ).value
    } ) )
    .then( res => res.json() )
    .then( res_json => {
      get_ele( '#update_records' ).innerHTML = JSON.stringify( res_json );
    } )
}

function deleteRecord () {
  let id = get_ele( '#delete_records_list' ).value;

  let fetch_url = `${API_PATH}/fights/${id}`;

  fetch(fetch_url , create_delete_config() )
  .then( res_json => {
    get_ele( '#update_records' ).innerHTML = JSON.stringify( res_json );
  } )
    .then( () => {
      refreshLists();
  })
}

function onReadSelectChange( ele_in ) {
  var id_to_read = ele_in.value;
  readRecord( id_to_read );
}

function emptyList ( ele_in ) {
  _.range( ele_in.options.length ).forEach( idx => {
    ele_in.remove( 0 );
  })

}

function refreshLists () {
  prepareRecordList( [
    get_ele( '#read_records_list' ),
    get_ele( '#update_records_list' ),
    get_ele( '#delete_records_list' )
  ] );
}

document.addEventListener( "DOMContentLoaded", function () {
  console.log( "helloworld" );

  refreshLists();
} );
function fetchUserList() {
  return fetch(`${API_PATH}/list_user`);
}

function clickListUser() {
  fetchUserList()
    .then(res => res.json())
    .then(res_json => {
      get_ele("#list_user_result").innerHTML = json_pretty_print(res_json);
    });
}

function insert_into_user_delete(ele_in, text, value) {
  ele_in.appendChild(new Option(text, value));
}

function insert_into_user_update(ele_in, text, value) {
  ele_in.appendChild(new Option(text, value));
}

function updateUserList() {
  fetchUserList()
    .then(res => res.json())
    .then(res_json => {
      let ele_delete_user_list = get_ele( "#delete_user_list" );
      let ele_update_user_list = get_ele( '#update_user_list' );
      Object.keys(res_json).forEach(_id => {
        insert_into_user_delete(ele_delete_user_list, _id, _id);
        insert_into_user_update(ele_update_user_list, _id, _id);
      });
    });
}

document.addEventListener("DOMContentLoaded", function() {
  updateUserList();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9jb21tb24uanMiLCJfdmFycy5qcyIsImxvZ2luLmpzIiwibWFpbi5qcyIsInVzZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGpzb25fcHJldHR5X3ByaW50IChqc29uX2luKSB7XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeSgganNvbl9pbiwgbnVsbCwgMiApO1xufSIsIlxudmFyIGhlbGxvd29ybGQgPSAnaGVsbG93b3JsZCc7XG5cbmNvbnN0IExPQ0FMX0FQSV9TRVJWRVIgPSAnaHR0cDovL2xvY2FsaG9zdDo1MDAwL3Rlc3QtZmlyZWJhc2UtM2EwZjYvdXMtY2VudHJhbDEnO1xuXG5jb25zdCBBUElfU0VSVkVSID0gTE9DQUxfQVBJX1NFUlZFUjtcblxuY29uc3QgQVBJX1BBVEggPSBgJHtBUElfU0VSVkVSfS9tYWluL2FwaS9qc3Rlc3RgO1xuXG5jb25zdCBNRVRIT0RfUE9TVCA9IHsgbWV0aG9kOiAnUE9TVCcgfTtcbmNvbnN0IE1FVEhPRF9QVVQgPSB7IG1ldGhvZDogJ1BVVCcgfTtcbmNvbnN0IE1FVEhPRF9ERUxFVEUgPSB7IG1ldGhvZDogJ0RFTEVURScgfTtcbmNvbnN0IEhFQURFUlNfSlNPTiA9IHsgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0gfTtcbiIsIlxuZnVuY3Rpb24gY2xpY2tMb2dpbiAoKSB7XG4gIGFsZXJ0KCAnbG9naW4gY2xpY2tlZCcgKTtcbn1cblxuZnVuY3Rpb24gcXVlcnlTdGF0dXMgKCkge1xuICBhbGVydCggJ3F1ZXJ5IFN0YXR1cyBjbGlja2VkJyApO1xufSIsImZ1bmN0aW9uIGhlbGxvd29ybGQoKSB7XG4gIGNvbnNvbGUubG9nKCAnaGVsbG93b3JsZCcgKTtcbn1cblxuY29uc3QgZ2V0X2VsZSA9ICggc2VsX2luICkgPT4ge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvciggc2VsX2luIClcbn07XG5jb25zdCBnZXRfZWxlcyA9ICggc2VsX2luICkgPT4ge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggc2VsX2luIClcbn07XG5cbmNvbnN0IHByZXBhcmVfZ2V0X3JlcXVlc3QgPSAoIGVuZHBvaW50ICkgPT4ge1xuICByZXR1cm4gZmV0Y2goIGAke0FQSV9QQVRIfS8ke2VuZHBvaW50fWAgKTtcbn1cblxuY29uc3QgcHJlcGFyZV9wdXRfcmVxdWVzdCA9ICggZW5kcG9pbnQgKSA9PiB7XG4gIHJldHVybiBmZXRjaCggYCR7QVBJX1BBVEh9LyR7ZW5kcG9pbnR9YCwgY3JlYXRlX2pzb25fcHV0X2NvbmZpZygpICk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZV9qc29uX3B1dF9jb25maWcoIGpzb25faW4gKSB7XG4gIHJldHVybiB7XG4gICAgLi4uTUVUSE9EX1BVVCxcbiAgICAuLi5IRUFERVJTX0pTT04sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoIGpzb25faW4gKVxuICB9O1xufVxuXG5jb25zdCBjcmVhdGVfZGVsZXRlX2NvbmZpZyA9ICggKSA9PiB7XG4gIHJldHVybiB7XG4gICAgLi4uTUVUSE9EX0RFTEVURVxuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVfanNvbl9wb3N0X2NvbmZpZygganNvbl9pbiApIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5NRVRIT0RfUE9TVCxcbiAgICAuLi5IRUFERVJTX0pTT04sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoIGpzb25faW4gKVxuICB9O1xufVxuXG5mdW5jdGlvbiBjbGlja0NyZWF0ZSgpIHtcbiAgZmV0Y2goIGAke0FQSV9QQVRIfS9jcmVhdGVfZmlnaHRgLCBjcmVhdGVfanNvbl9wb3N0X2NvbmZpZygge1xuICAgICAgd2lubmVyOiBnZXRfZWxlKCAnI2NyZWF0ZV93aW5uZXInICkudmFsdWUsXG4gICAgICBsb3NzZXI6IGdldF9lbGUoICcjY3JlYXRlX2xvc3NlcicgKS52YWx1ZSxcbiAgICAgIHRpdGxlOiBnZXRfZWxlKCAnI2NyZWF0ZV90aXRsZScgKS52YWx1ZVxuICAgIH0gKSApXG4gICAgLnRoZW4oIHJlcyA9PiByZXMuanNvbigpIClcbiAgICAudGhlbiggcmVzX2pzb24gPT4ge1xuICAgICAgcmVmcmVzaExpc3RzKCk7XG4gICAgICBnZXRfZWxlKCAnI2NyZWF0ZV9yZXN1bHQnICkuaW5uZXJIVE1MID0gSlNPTi5zdHJpbmdpZnkoIHJlc19qc29uICk7XG4gICAgfSApXG5cbn1cblxuZnVuY3Rpb24gY2xpY2tfZWNob19nZXQoKSB7XG4gIGZldGNoKCBgJHtBUElfUEFUSH0vZWNob19nZXQ/cT0xMjM0YCApXG4gICAgLnRoZW4oIHJlcyA9PiByZXMudGV4dCgpIClcbiAgICAudGhlbiggcmVzX3RleHQgPT4ge1xuICAgICAgY29uc29sZS5sb2coIHJlc190ZXh0IClcbiAgICAgIGdldF9lbGUoICcjZWNob19nZXQnICkuaW5uZXJIVE1MID0gcmVzX3RleHQ7XG4gICAgfSApXG59XG5cbmZ1bmN0aW9uIGNsaWNrX2hlbGxvX2dldCgpIHtcbiAgZmV0Y2goIGAke0FQSV9QQVRIfS9oZWxsb19nZXRgIClcbiAgICAudGhlbiggcmVzID0+IHJlcy50ZXh0KCkgKVxuICAgIC50aGVuKCByZXNfdGV4dCA9PiB7XG4gICAgICBjb25zb2xlLmxvZyggcmVzX3RleHQgKTtcbiAgICAgIGdldF9lbGUoICcjaGVsbG9fZ2V0JyApLmlubmVySFRNTCA9IHJlc190ZXh0O1xuICAgIH0gKVxufVxuXG5mdW5jdGlvbiBjbGlja19saXN0X2FsbCgpIHtcbiAgZmV0Y2goIGAke0FQSV9QQVRIfS9maWdodHNgIClcbiAgICAudGhlbiggcmVzID0+IHJlcy5qc29uKCkgKVxuICAgIC50aGVuKCByZXNfanNvbiA9PiB7XG4gICAgICBnZXRfZWxlKCAnI2xpc3RfYWxsX3Jlc3VsdCcgKS5pbm5lckhUTUwgPSBKU09OLnN0cmluZ2lmeSggcmVzX2pzb24gKTtcbiAgICB9IClcbn1cblxuZnVuY3Rpb24gZmV0Y2hfcmVjb3JkcygpIHtcbiAgcmV0dXJuIGZldGNoKCBgJHtBUElfUEFUSH0vZmlnaHRzYCApXG4gICAgLnRoZW4oIHJlcyA9PiByZXMuanNvbigpICk7XG59XG5cbmZ1bmN0aW9uIHByZXBhcmVSZWNvcmRMaXN0ICggZWxlc19pbiApIHtcblxuICBmZXRjaF9yZWNvcmRzKClcbiAgICAudGhlbiggcmVzX2pzb24gPT4ge1xuICAgICAgZWxlc19pbi5mb3JFYWNoKCBlbGVfaW4gPT4ge1xuICAgICAgICBlbXB0eUxpc3QoZWxlX2luKTtcbiAgICAgICAgT2JqZWN0LmtleXMoIHJlc19qc29uICkuZm9yRWFjaCggX2lkID0+IHtcbiAgICAgICAgICB2YXIgc2VsID0gZWxlX2luO1xuICAgICAgICAgIHZhciBvcHQxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJvcHRpb25cIiApO1xuICAgICAgICAgIG9wdDEudmFsdWUgPSBfaWQ7XG4gICAgICAgICAgb3B0MS50ZXh0ID0gX2lkO1xuICAgICAgICAgIHNlbC5hZGQoIG9wdDEsIG51bGwgKTtcbiAgICAgICAgfSApO1xuICAgICAgfSlcblxuXG4gICAgfSApXG59XG5cbmZ1bmN0aW9uIGxvYWRSZWNvcmQoIGlkX2luICkge1xuICByZXR1cm4gcHJlcGFyZV9nZXRfcmVxdWVzdCggYC9maWdodC8ke2lkX2lufWAgKVxuICAgIC50aGVuKCByZXMgPT4gcmVzLmpzb24oKSApXG5cbn1cblxuZnVuY3Rpb24gcmVhZFJlY29yZCggaWRfaW4gKSB7XG4gIHByZXBhcmVfZ2V0X3JlcXVlc3QoIGAvZmlnaHQvJHtpZF9pbn1gIClcbiAgICAudGhlbiggcmVzID0+IHJlcy5qc29uKCkgKVxuICAgIC50aGVuKCByZXNfanNvbiA9PiB7XG4gICAgICBnZXRfZWxlKCAnI3JlYWRfd2lubmVyJyApLnZhbHVlID0gcmVzX2pzb24udmFsdWUud2lubmVyO1xuICAgICAgZ2V0X2VsZSggJyNyZWFkX2xvc3NlcicgKS52YWx1ZSA9IHJlc19qc29uLnZhbHVlLmxvc3NlcjtcbiAgICAgIGdldF9lbGUoICcjcmVhZF90aXRsZScgKS52YWx1ZSA9IHJlc19qc29uLnZhbHVlLnRpdGxlO1xuICAgIH0gKVxufVxuXG5mdW5jdGlvbiBvblVwZGF0ZVNlbGVjdENoYW5nZSggZWxlX2luICkge1xuICB2YXIgaWRfdG9fbG9hZCA9IGVsZV9pbi52YWx1ZTtcbiAgbG9hZFJlY29yZCggaWRfdG9fbG9hZCApXG4gICAgLnRoZW4oIHJlc19qc29uID0+IHtcbiAgICAgIGdldF9lbGUoICcjdXBkYXRlX3dpbm5lcicgKS52YWx1ZSA9IHJlc19qc29uLnZhbHVlLndpbm5lcjtcbiAgICAgIGdldF9lbGUoICcjdXBkYXRlX2xvc3NlcicgKS52YWx1ZSA9IHJlc19qc29uLnZhbHVlLmxvc3NlcjtcbiAgICAgIGdldF9lbGUoICcjdXBkYXRlX3RpdGxlJyApLnZhbHVlID0gcmVzX2pzb24udmFsdWUudGl0bGU7XG4gICAgfSApXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVJlY29yZCgpIHtcbiAgdmFyIGlkX3RvX3VwZGF0ZSA9IGdldF9lbGUoICcjdXBkYXRlX3JlY29yZHNfbGlzdCcgKS52YWx1ZTtcbiAgdmFyIGZldGNoX3VybCA9IGAke0FQSV9QQVRIfS9maWdodHMvJHtpZF90b191cGRhdGV9YDtcbiAgY29uc29sZS5sb2coIGZldGNoX3VybCApO1xuXG4gIGZldGNoKCBmZXRjaF91cmwsIGNyZWF0ZV9qc29uX3B1dF9jb25maWcoIHtcbiAgICAgIC8vIHdpbm5lcjogZ2V0X2VsZSggJyN1cGRhdGVfd2lubmVyJyApLnZhbHVlLFxuICAgICAgLy8gbG9zc2VyOiBnZXRfZWxlKCAnI3VwZGF0ZV9sb3NzZXInICkudmFsdWUsXG4gICAgICB0aXRsZTogZ2V0X2VsZSggJyN1cGRhdGVfdGl0bGUnICkudmFsdWVcbiAgICB9ICkgKVxuICAgIC50aGVuKCByZXMgPT4gcmVzLmpzb24oKSApXG4gICAgLnRoZW4oIHJlc19qc29uID0+IHtcbiAgICAgIGdldF9lbGUoICcjdXBkYXRlX3JlY29yZHMnICkuaW5uZXJIVE1MID0gSlNPTi5zdHJpbmdpZnkoIHJlc19qc29uICk7XG4gICAgfSApXG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVJlY29yZCAoKSB7XG4gIGxldCBpZCA9IGdldF9lbGUoICcjZGVsZXRlX3JlY29yZHNfbGlzdCcgKS52YWx1ZTtcblxuICBsZXQgZmV0Y2hfdXJsID0gYCR7QVBJX1BBVEh9L2ZpZ2h0cy8ke2lkfWA7XG5cbiAgZmV0Y2goZmV0Y2hfdXJsICwgY3JlYXRlX2RlbGV0ZV9jb25maWcoKSApXG4gIC50aGVuKCByZXNfanNvbiA9PiB7XG4gICAgZ2V0X2VsZSggJyN1cGRhdGVfcmVjb3JkcycgKS5pbm5lckhUTUwgPSBKU09OLnN0cmluZ2lmeSggcmVzX2pzb24gKTtcbiAgfSApXG4gICAgLnRoZW4oICgpID0+IHtcbiAgICAgIHJlZnJlc2hMaXN0cygpO1xuICB9KVxufVxuXG5mdW5jdGlvbiBvblJlYWRTZWxlY3RDaGFuZ2UoIGVsZV9pbiApIHtcbiAgdmFyIGlkX3RvX3JlYWQgPSBlbGVfaW4udmFsdWU7XG4gIHJlYWRSZWNvcmQoIGlkX3RvX3JlYWQgKTtcbn1cblxuZnVuY3Rpb24gZW1wdHlMaXN0ICggZWxlX2luICkge1xuICBfLnJhbmdlKCBlbGVfaW4ub3B0aW9ucy5sZW5ndGggKS5mb3JFYWNoKCBpZHggPT4ge1xuICAgIGVsZV9pbi5yZW1vdmUoIDAgKTtcbiAgfSlcblxufVxuXG5mdW5jdGlvbiByZWZyZXNoTGlzdHMgKCkge1xuICBwcmVwYXJlUmVjb3JkTGlzdCggW1xuICAgIGdldF9lbGUoICcjcmVhZF9yZWNvcmRzX2xpc3QnICksXG4gICAgZ2V0X2VsZSggJyN1cGRhdGVfcmVjb3Jkc19saXN0JyApLFxuICAgIGdldF9lbGUoICcjZGVsZXRlX3JlY29yZHNfbGlzdCcgKVxuICBdICk7XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnNvbGUubG9nKCBcImhlbGxvd29ybGRcIiApO1xuXG4gIHJlZnJlc2hMaXN0cygpO1xufSApOyIsImZ1bmN0aW9uIGZldGNoVXNlckxpc3QoKSB7XG4gIHJldHVybiBmZXRjaChgJHtBUElfUEFUSH0vbGlzdF91c2VyYCk7XG59XG5cbmZ1bmN0aW9uIGNsaWNrTGlzdFVzZXIoKSB7XG4gIGZldGNoVXNlckxpc3QoKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgIC50aGVuKHJlc19qc29uID0+IHtcbiAgICAgIGdldF9lbGUoXCIjbGlzdF91c2VyX3Jlc3VsdFwiKS5pbm5lckhUTUwgPSBqc29uX3ByZXR0eV9wcmludChyZXNfanNvbik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGluc2VydF9pbnRvX3VzZXJfZGVsZXRlKGVsZV9pbiwgdGV4dCwgdmFsdWUpIHtcbiAgZWxlX2luLmFwcGVuZENoaWxkKG5ldyBPcHRpb24odGV4dCwgdmFsdWUpKTtcbn1cblxuZnVuY3Rpb24gaW5zZXJ0X2ludG9fdXNlcl91cGRhdGUoZWxlX2luLCB0ZXh0LCB2YWx1ZSkge1xuICBlbGVfaW4uYXBwZW5kQ2hpbGQobmV3IE9wdGlvbih0ZXh0LCB2YWx1ZSkpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVVc2VyTGlzdCgpIHtcbiAgZmV0Y2hVc2VyTGlzdCgpXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgLnRoZW4ocmVzX2pzb24gPT4ge1xuICAgICAgbGV0IGVsZV9kZWxldGVfdXNlcl9saXN0ID0gZ2V0X2VsZSggXCIjZGVsZXRlX3VzZXJfbGlzdFwiICk7XG4gICAgICBsZXQgZWxlX3VwZGF0ZV91c2VyX2xpc3QgPSBnZXRfZWxlKCAnI3VwZGF0ZV91c2VyX2xpc3QnICk7XG4gICAgICBPYmplY3Qua2V5cyhyZXNfanNvbikuZm9yRWFjaChfaWQgPT4ge1xuICAgICAgICBpbnNlcnRfaW50b191c2VyX2RlbGV0ZShlbGVfZGVsZXRlX3VzZXJfbGlzdCwgX2lkLCBfaWQpO1xuICAgICAgICBpbnNlcnRfaW50b191c2VyX3VwZGF0ZShlbGVfdXBkYXRlX3VzZXJfbGlzdCwgX2lkLCBfaWQpO1xuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xuICB1cGRhdGVVc2VyTGlzdCgpO1xufSk7XG4iXX0=
